#!/usr/bin/env bash

set -euo pipefail

# shellcheck source=./utils.sh
source "$RTX_PLUGIN_PATH/bin/utils.sh"

setup_pipenv() {
    VIRTUAL_ENV=$(pipenv_venv)
    if [[ -z $VIRTUAL_ENV || ! -d $VIRTUAL_ENV ]]; then
        "$(pipenv_bin)" install --dev
        VIRTUAL_ENV=$(pipenv --venv)
    fi
    PIPENV_ACTIVE=1
    RTX_ADD_PATH="$VIRTUAL_ENV/bin"
    export VIRTUAL_ENV PIPENV_ACTIVE RTX_ADD_PATH
}

setup_pipenv
